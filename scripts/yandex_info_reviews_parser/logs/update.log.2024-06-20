[2024-06-20 07:52:08,535] p1736 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py:245} INFO - len final_df before filter 117639
[2024-06-20 07:52:08,672] p1736 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py:267} INFO - len final_df after filter 94483
[2024-06-20 07:52:08,783] p1736 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py:278} INFO - I will save reviews length of 94481
[2024-06-20 07:52:08,783] p1736 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py:279} INFO - final_df.shape (94481, 8)
[2024-06-20 07:52:08,784] p1736 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py:280} INFO - unique banks 343
[2024-06-20 07:52:08,829] p1736 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py:281} INFO - unique cities 1
[2024-06-20 07:52:25,199] p1736 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py:289} INFO - I saved reviews length of 94481
[2024-06-20 07:54:10,276] p1879 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/log.py:29} ERROR - Logging an uncaught exception
Traceback (most recent call last):
  File "/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py", line 309, in <module>
    merge_all_reviews(bank_name, path, drop_errors=False, filter_by_info_df=True)
  File "/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py", line 244, in merge_all_reviews
    final_df['id'] = final_df['id'].astype('int')
TypeError: 'NoneType' object is not subscriptable
[2024-06-20 07:54:49,249] p1941 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py:245} INFO - len final_df before filter 26935
[2024-06-20 07:54:49,249] p1941 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/log.py:29} ERROR - Logging an uncaught exception
Traceback (most recent call last):
  File "/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py", line 309, in <module>
    merge_all_reviews(bank_name, path, drop_errors=False, filter_by_info_df=True)
  File "/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py", line 247, in merge_all_reviews
    info_df = pd.read_csv(f'{path}/info_all/{bank_name}_info_all.csv')
  File "/Users/anyarulina/miniconda3/envs/main/lib/python3.9/site-packages/pandas/util/_decorators.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/Users/anyarulina/miniconda3/envs/main/lib/python3.9/site-packages/pandas/io/parsers/readers.py", line 680, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/Users/anyarulina/miniconda3/envs/main/lib/python3.9/site-packages/pandas/io/parsers/readers.py", line 575, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/Users/anyarulina/miniconda3/envs/main/lib/python3.9/site-packages/pandas/io/parsers/readers.py", line 933, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/Users/anyarulina/miniconda3/envs/main/lib/python3.9/site-packages/pandas/io/parsers/readers.py", line 1217, in _make_engine
    self.handles = get_handle(  # type: ignore[call-overload]
  File "/Users/anyarulina/miniconda3/envs/main/lib/python3.9/site-packages/pandas/io/common.py", line 789, in get_handle
    handle = open(
FileNotFoundError: [Errno 2] No such file or directory: '/Users/anyarulina/parser/scripts/yandex_info_reviews_parser//info_all/alfa_bank_info_all.csv'
[2024-06-20 07:55:27,007] p1967 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py:169} INFO - cities_without_bank 6
[2024-06-20 07:55:27,008] p1967 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py:176} INFO - final df
[2024-06-20 07:55:27,017] p1967 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py:178} INFO - final_df.shape (7, 16)
[2024-06-20 07:55:27,164] p1967 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py:191} INFO - 2 unique cities saved
[2024-06-20 07:55:27,164] p1967 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py:207} INFO - not handled 629 cities: {'Избербаш', 'Волжск', 'Лиски', 'Ершов', 'Печора', 'Аксай', 'Усть-Кут', 'Шахунья', 'Лабытнанги', 'Жуковский', 'Тайга', 'Саратов', 'Заринск', 'Коломна', 'Пугачёв', 'Можга', 'Прохладный', 'Рубцовск', 'Юрга', 'Артёмовский', 'Валуйки', 'Нижнесортымский', 'Ноябрьск', 'п. Придорожный', 'Каменск-Уральский', 'Чернушка', 'Сафоново', 'Бронницы', 'Минусинск', 'Березники', 'Полярные зори', 'Королёв', 'Кизляр', 'Кимры', 'Чита', 'Черняховск', 'Елизово', 'Первоуральск', 'Арсеньев', 'Волгоград', 'Норильск', 'Камышин', 'Шелехов', 'Алексеевка', 'Зубова Поляна', 'Комсомольск-на-Амуре', 'Невинномысск', 'Энгельс', 'Артём', 'Тейково', 'Дубна', 'Полярный', 'Старый Оскол', 'Шарыпово', 'Дятьково', 'Лыткарино', 'Советск', 'Сочи', 'Шарья', 'Ржев', 'Астрахань', 'Амурск', 'Вилючинск', 'Райчихинск', 'Белово', 'Кызыл', 'Ангарск', 'Красноуфимск', 'Осинники', 'Реутов', 'Тимашевск', 'р.п. Кольцово', 'Ленинск-Кузнецкий', 'Сальск', 'Ленск', 'Пенза', 'Новокуйбышевск', 'Агрыз', 'Кировск', 'Саянск', 'Черепаново', 'Качканар', 'Александров', 'Майкоп', 'Горноправдинск', 'Федоровский', 'Зима', 'Луга', 'Советский', 'Переславль-Залесский', 'Алексин', 'Искитим', 'Сергиев Посад', 'Могоча', 'Лянтор', 'Павлово', 'Новомосковск', 'Клинцы', 'Уссурийск', 'Южно-Сахалинск', 'Каспийск', 'Заволжье', 'Партизанск', 'Котлас', 'Карталы', 'Рязань', 'Семёнов', 'Лотошино', 'Ногинск', 'Оленегорск', 'Новороссийск', 'Белая Калитва', 'Сердобск', 'Северобайкальск', 'Ефремов', 'Кириши', 'Мыски', 'Звенигород', 'Рыбинск', 'Канск', 'Ува', 'Будённовск', 'Славянск-на-Кубани', 'Волоколамск', 'Магнитогорск', 'Чапаевск', 'Мичуринск', 'Стрежевой', 'п. Междуреченский', 'Соль-Илецк', 'Тарко-Сале', 'Фрязино', 'Хилок', 'Подольск', 'Выкса', 'Сегежа', 'Саров', 'Саранск', 'Кирово-Чепецк', 'Дзержинск', 'Саяногорск', 'Краснокамск', 'Мегион', 'Елабуга', 'Ревда', 'ст. Павловская', 'Костомукша', 'Чистополь', 'Верхняя Салда', 'Сосновый Бор', 'Шадринск', 'Новоуральск', 'Великий Новгород', 'Урус-Мартан', 'пос. Персиановский', 'Абинск', 'Туймазы', 'Ачинск', 'Находка', 'Железногорск', 'Балашов', 'Кольчугино', 'Зарайск', 'Раменское', 'Североуральск', 'п. Таксимо', 'Омск', 'Копейск', 'Елец', 'Киселёвск', 'Звенигово', 'Надым', 'Нягань', 'Кореновск', 'Дальнереченск', 'Солнечногорск', 'Тутаев', 'Кимовск', 'Свободный', 'Жуков', 'Зеленогорск', 'Мурманск', 'Черногорск', 'Снежинск', 'Усинск', 'Павловский Посад', 'Новый Уренгой', 'Шуя', 'Железнодорожный', 'п. Магдагачи', 'Колпино', 'Стерлитамак', 'Завитинск', 'Армавир', 'Петергоф', 'Татарск', 'Шумерля', 'Гурьевск', 'Егорьевск', 'Краснотурьинск', 'Кяхта', 'Людиново', 'Новый Оскол', 'Ртищево', 'Богданович', 'Сковородино', 'Сургут', 'Троицк', 'Выборг', 'Аткарск', 'Губкинский', 'Козьмодемьянск', 'Курган', 'Михайловка', 'Чехов', 'п. Светлый', 'Гагарин', 'Ухта', 'Оренбург', 'Хотьково', 'Томск', 'Вязники', 'Абакан', 'Каменск-Шахтинский', 'Вихоревка', 'Полевской', 'Вольск', 'Иваново', 'Назрань', 'Отрадный', 'Туапсе', 'Махачкала', 'Альметьевск', 'Геленджик', 'ЗАТО Сибирский', 'Сатка', 'Серпухов', 'Краснодар', 'Донской', 'Грозный', 'Димитровград', 'Зеленоград', 'Сарапул', 'Владимир', 'Владикавказ', 'Заозёрск', 'Щёлково', 'Грязи', 'Черноголовка', 'Всеволожск', 'Киров', 'Мирный', 'Богородск', 'Ялуторовск', 'Тамань', 'Арск', 'Сестрорецк', 'Сибай', 'Нижнекамск', 'Кондопога', 'Анадырь', 'Горячий Ключ', 'Новосибирск', 'Чебоксары', 'Удомля', 'Михайловск', 'Алатырь', 'Заинск', 'п. Свободный', 'Агинское', 'Югорск', 'Озерск', 'Магадан', 'Спасск-Дальний', 'Волжский', 'Губаха', 'Пойковский', 'Дзержинский', 'Орёл', 'Элиста', 'Новошахтинск', 'Десногорск', 'Коркино', 'Мценск', 'Екатеринбург', 'Кинель', 'Коряжма', 'Новодвинск', 'Строитель', 'Дербент', 'Урай', 'д. Жуковка', 'Балахна', 'Балтийск', 'Протвино', 'Дивногорск', 'Иланский', 'Гусев', 'Сасово', 'Минеральные воды', 'Уфа', 'Электросталь', 'Воскресенск', 'Старая Русса', 'Ставрополь', 'Петропавловск-Камчатский', 'Мариинск', 'Новочебоксарск', 'Губкин', 'Корсаков', 'Обнинск', 'Бугуруслан', 'Заполярный', 'Иркутск', 'Усть-Лабинск', 'Анжеро-Судженск', 'Кострома', 'Тосно', 'Тара', 'Бузулук', 'Ессентуки', 'Чайковский', 'Вологда', 'Самара', 'Октябрьский', 'Пушкин', 'Кемь', 'Ростов-на-Дону', 'Соликамск', 'Долгопрудный', 'Лабинск', 'Бугульма', 'Батайск', 'Железногорск-Илимский', 'Псков', 'Северск', 'Жигулёвск', 'Хабаровск', 'Шимановск', 'Нижний Тагил', 'Темрюк', 'Заводоуковск', 'пгт. Промышленная', 'Бирск', 'Нерюнгри', 'Кинешма', 'Азов', 'Муром', 'Исилькуль', 'Алейск', 'Красный Сулин', 'Россошь', 'п. Голышманово', 'Крымск', 'Североморск', 'Нижнеудинск', 'Асбест', 'пгт. Чернышевск', 'Фурманов', 'Наро-Фоминск', 'Буинск', 'Колпашево', 'Ступино', 'Тайшет', 'Куровское', 'Рассказово', 'Усолье-Сибирское', 'Зеленодольск', 'Архангельск', 'пгт. Забайкальск', 'Ханты-Мансийск', 'Радужный', 'Череповец', 'Шаховская', 'Бологое', 'Оса', 'Касимов', 'Воткинск', 'Казань', 'Глазов', 'Сортавала', 'Краснознаменск', 'Прокопьевск', 'Лобня', 'Химки', 'Ряжск', 'Красногорск', 'Кропоткин', 'Новотроицк', 'Ижевск', 'Трёхгорный', 'Гусь-Хрустальный', 'Кашира', 'Белоярский', 'Кандалакша', 'Камень-на-Оби', 'Гусиноозёрск', 'Анапа', 'Санкт-Петербург', 'Гуково', 'Ахтубинск', 'Муравленко', 'Новокузнецк', 'Малиновский', 'Котельнич', 'Рузаевка', 'Первомайск', 'Шатура', 'Щёкино', 'Клин', 'Алапаевск', 'Заречный', 'Рославль', 'Нарьян-Мар', 'Челябинск', 'п. Тазовский', 'Петровск-Забайкальский', 'Серов', 'Куйбышев', 'Кунгур', 'Нефтеюганск', 'Барнаул', 'Асино', 'Кингисепп', 'п. Излучинск', 'Мончегорск', 'Советская Гавань', 'Узловая', 'Тулун', 'Ирбит', 'п. Новый Ургал', 'Московский', 'Тамбов', 'Малоярославец', 'Сертолово', 'Чусовой', 'р.п. Сенной', 'Богородицк', 'Киреевск', 'Тербуны', 'Кукмор', 'Калачинск', 'Льгов', 'Красноармейск', 'Видное', 'Истра', 'Моршанск', 'Балашиха', 'Боровичи', 'Гатчина', 'Тула', 'Орск', 'Ишим', 'Миасс', 'Пушкино', 'Новоалтайск', 'Борисоглебск', 'Кисловодск', 'Покачи', 'Златоуст', 'Курчатов', 'Слободской', 'Черкесск', 'Бердск', 'Жирновск', 'Холмск', 'Белгород', 'Волгодонск', 'Владивосток', 'Донецк', 'Кудрово', 'Тында', 'Борзя', 'Липецк', 'Барабинск', 'Тольятти', 'Славгород', 'Белорецк', 'Тверь', 'Курск', 'Калуга', 'Нижний Новгород', 'Вязьма', 'Лысьва', 'Люберцы', 'Вышний Волочёк', 'Лебедянь', 'Горно-Алтайск', 'Бор', 'Нововоронеж', 'п. Новоорск', 'Карасук', 'Сосногорск', 'Новочеркасск', 'Берёзово', 'Сызрань', 'Братск', 'Улан-Удэ', 'Усть-Илимск', 'Петрозаводск', 'Миллерово', 'Суворов', 'Чебаркуль', 'Когалым', 'Слюдянка', 'пгт. Новая Чара', 'Калининград', 'Северодвинск', 'Камышлов', 'с. Красноселькуп', 'ст. Талица', 'Курганинск', 'Фролово', 'Болотное', 'Дальнегорск', 'Одинцово', 'Ейск', 'Черемхово', 'Южноуральск', 'Талдом', 'Нурлат', 'Арзамас', 'Пыть-Ях', 'Орехово-Зуево', 'Ярцево', 'Ливны', 'Берёзовский', 'Дюртюли', 'Воркута', 'Ивантеевка', 'Сыктывкар', 'п. Мурино', 'п. Ванино', 'Благовещенск', 'Изобильный', 'Бийск', 'Нальчик', 'Баксан', 'Верещагино', 'Алдан', 'Урюпинск', 'Пятигорск', 'Удачный', 'Лениногорск', 'Назарово', 'Топки', 'Краснокаменск', 'Светлоград', 'Малгобек', 'Пущино', 'Междуреченск', 'п. Айхал', 'Моздок', 'Белебей', 'пос. Саянский', 'Кемерово', 'Торжок', 'Игрим', 'Шушары', 'Ишимбай', 'Набережные Челны', 'Ковров', 'Тихвин', 'Апрелевка', 'Дмитров', 'Шахты', 'Пермь', 'Конаково', 'Сосновоборск', 'Реж', 'Биробиджан', 'Домодедово', 'Шилка', 'Салехард', 'Белогорск', 'Апшеронск', 'Красноярск', 'Нижневартовск', 'Хасавюрт', 'Верхняя Пышма', 'Йошкар-Ола', 'Смоленск', 'Брянск', 'Воронеж', 'Лесосибирск', 'Фокино', 'Аргун', 'Мелеуз', 'Волхов', 'Можайск', 'Лесозаводск', 'Буй', 'Лучегорск', 'Ярославль', 'Дедовск', 'Луховицы', 'Мытищи', 'Великие Луки', 'Гудермес', 'пгт. Карымское', 'р.п. Краснообск', 'Кулебаки', 'Тихорецк', 'Большой Камень', 'Таштагол', 'Тюмень', 'Балабаново', 'Лангепас', 'Ясный', 'Якутск', 'Тобольск', 'Кушва', 'Нефтекамск', 'Кстово', 'Георгиевск', 'Лесной', 'Городец', 'Боготол', 'Балаково', 'Кумертау', 'Белореченск', 'Каменка', 'п. Ерофей Павлович', 'Кузнецк', 'Шали', 'Канаш', 'Таганрог', 'Карабулак', 'Салават'}
[2024-06-20 07:55:31,476] p1967 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py:245} INFO - len final_df before filter 26935
[2024-06-20 07:55:31,503] p1967 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py:267} INFO - len final_df after filter 1165
[2024-06-20 07:55:31,507] p1967 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py:278} INFO - I will save reviews length of 1165
[2024-06-20 07:55:31,508] p1967 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py:279} INFO - final_df.shape (1165, 8)
[2024-06-20 07:55:31,508] p1967 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py:280} INFO - unique banks 4
[2024-06-20 07:55:31,508] p1967 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py:281} INFO - unique cities 1
[2024-06-20 07:55:31,813] p1967 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/after_work.py:289} INFO - I saved reviews length of 1165
[2024-06-20 15:54:12,274] p11424 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/call_yandex_api_org.py:313} INFO - cities_dict length for alfa_bank 662
[2024-06-20 15:54:12,274] p11424 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/log.py:29} ERROR - Logging an uncaught exception
Traceback (most recent call last):
  File "/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/call_yandex_api_org.py", line 352, in <module>
    get_cities_dict(bank_name, path, check_existing=False)
  File "/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/call_yandex_api_org.py", line 317, in get_cities_dict
    with open(f'{path}/cities_1.txt') as f:
FileNotFoundError: [Errno 2] No such file or directory: '/Users/anyarulina/parser/scripts/yandex_info_reviews_parser//cities_1.txt'
[2024-06-20 15:55:32,418] p11495 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/call_yandex_api_org.py:313} INFO - cities_dict length for alfa_bank 662
[2024-06-20 15:55:32,418] p11495 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/call_yandex_api_org.py:323} INFO - input cities length 631
[2024-06-20 15:55:32,418] p11495 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/call_yandex_api_org.py:330} INFO - I will update 631 cities for alfa_bank
[2024-06-20 15:55:32,419] p11495 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/call_yandex_api_org.py:214} INFO - current limit is 500
[2024-06-20 15:55:32,699] p11495 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/call_yandex_api_org.py:224} INFO - Абакан yndx_id 95773847314
[2024-06-20 15:55:34,706] p11495 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/call_yandex_api_org.py:245} INFO - 1 cities updated in cities dictionary
[2024-06-20 15:55:35,098] p11495 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/call_yandex_api_org.py:224} INFO - Абинск yndx_id 147054140486
[2024-06-20 15:55:56,811] p11545 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/pipeline_links.py:68} INFO - launch get links for alfa_bank at 2024-06-20 15:55:56.811512
[2024-06-20 15:55:56,811] p11545 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/pipeline_links.py:74} INFO - 656 not null cities
[2024-06-20 15:55:56,812] p11545 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/pipeline_links.py:31} INFO - start get links for alfa_bank at 2024-06-20 15:55:56.812044
[2024-06-20 15:55:56,812] p11545 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/get_links.py:121} INFO - I will get links for 656 cities
[2024-06-20 15:55:56,812] p11545 {/Users/anyarulina/parser/scripts/yandex_info_reviews_parser/get_links.py:126} INFO - sleeping for 22.86 seconds
